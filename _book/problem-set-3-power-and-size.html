<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Problem Set 3: Power and Size | Script Introduction to Data Analysis</title>
  <meta name="description" content="Introduction to Data Analysis" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Problem Set 3: Power and Size | Script Introduction to Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introduction to Data Analysis" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Problem Set 3: Power and Size | Script Introduction to Data Analysis" />
  
  <meta name="twitter:description" content="Introduction to Data Analysis" />
  

<meta name="author" content="Lena Janys" />


<meta name="date" content="2019-11-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="problem-set-2.html"/>
<link rel="next" href="problem-set-4-np-density-estimation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Course Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#list"><i class="fa fa-check"></i><b>1.1</b> List of Topics</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#method"><i class="fa fa-check"></i><b>1.2</b> Methods</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#data"><i class="fa fa-check"></i><b>1.2.1</b> Data</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#tools"><i class="fa fa-check"></i><b>1.2.2</b> Tools</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#exam"><i class="fa fa-check"></i><b>1.3</b> Exam</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#timetable"><i class="fa fa-check"></i><b>1.4</b> Timetable</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#the-r-principle"><i class="fa fa-check"></i><b>2.1</b> The R-Principle</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#assigments"><i class="fa fa-check"></i><b>2.2</b> Assigments</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#saving-and-removing-objects"><i class="fa fa-check"></i><b>2.3</b> Saving and removing objects</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-help"><i class="fa fa-check"></i><b>2.4</b> R Help</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-the-editor"><i class="fa fa-check"></i><b>2.5</b> Using the editor</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#working-directory"><i class="fa fa-check"></i><b>2.6</b> Working directory</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="operators.html"><a href="operators.html"><i class="fa fa-check"></i><b>3</b> Operators</a></li>
<li class="chapter" data-level="4" data-path="data-structures-vectors-matrices-lists.html"><a href="data-structures-vectors-matrices-lists.html"><i class="fa fa-check"></i><b>4</b> Data structures: vectors, matrices, lists</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures-vectors-matrices-lists.html"><a href="data-structures-vectors-matrices-lists.html#numerical-and-non-numeric-objects"><i class="fa fa-check"></i><b>4.1</b> Numerical and non-numeric objects</a></li>
<li class="chapter" data-level="4.2" data-path="data-structures-vectors-matrices-lists.html"><a href="data-structures-vectors-matrices-lists.html#vectors"><i class="fa fa-check"></i><b>4.2</b> Vectors</a></li>
<li class="chapter" data-level="4.3" data-path="data-structures-vectors-matrices-lists.html"><a href="data-structures-vectors-matrices-lists.html#matrices"><i class="fa fa-check"></i><b>4.3</b> Matrices</a></li>
<li class="chapter" data-level="4.4" data-path="data-structures-vectors-matrices-lists.html"><a href="data-structures-vectors-matrices-lists.html#lists"><i class="fa fa-check"></i><b>4.4</b> Lists</a></li>
<li class="chapter" data-level="4.5" data-path="data-structures-vectors-matrices-lists.html"><a href="data-structures-vectors-matrices-lists.html#data-frames"><i class="fa fa-check"></i><b>4.5</b> Data Frames</a></li>
<li class="chapter" data-level="4.6" data-path="data-structures-vectors-matrices-lists.html"><a href="data-structures-vectors-matrices-lists.html#working-with-logical-operators"><i class="fa fa-check"></i><b>4.6</b> Working with logical operators</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exercises-simple-data-structures.html"><a href="exercises-simple-data-structures.html"><i class="fa fa-check"></i><b>5</b> Exercises: Simple Data structures</a><ul>
<li class="chapter" data-level="5.1" data-path="exercises-simple-data-structures.html"><a href="exercises-simple-data-structures.html#r-as-a-calculator"><i class="fa fa-check"></i><b>5.1</b> R as a calculator</a></li>
<li class="chapter" data-level="5.2" data-path="exercises-simple-data-structures.html"><a href="exercises-simple-data-structures.html#numerical-and-nonnumerical-objects"><i class="fa fa-check"></i><b>5.2</b> Numerical and Nonnumerical Objects</a></li>
<li class="chapter" data-level="5.3" data-path="exercises-simple-data-structures.html"><a href="exercises-simple-data-structures.html#vectors-1"><i class="fa fa-check"></i><b>5.3</b> Vectors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-functions.html"><a href="statistical-functions.html"><i class="fa fa-check"></i><b>6</b> Statistical functions</a><ul>
<li class="chapter" data-level="6.1" data-path="statistical-functions.html"><a href="statistical-functions.html#sums-and-frequencies"><i class="fa fa-check"></i><b>6.1</b> Sums and frequencies</a></li>
<li class="chapter" data-level="6.2" data-path="statistical-functions.html"><a href="statistical-functions.html#frequencies"><i class="fa fa-check"></i><b>6.2</b> Frequencies</a></li>
<li class="chapter" data-level="6.3" data-path="statistical-functions.html"><a href="statistical-functions.html#statistical-distributions"><i class="fa fa-check"></i><b>6.3</b> Statistical Distributions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="statistical-functions.html"><a href="statistical-functions.html#normal-distribution"><i class="fa fa-check"></i><b>6.3.1</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3.2" data-path="statistical-functions.html"><a href="statistical-functions.html#binomial-distribution"><i class="fa fa-check"></i><b>6.3.2</b> Binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="statistical-functions.html"><a href="statistical-functions.html#multiplication-of-a-random-variable-with-a-constant"><i class="fa fa-check"></i><b>6.4</b> Multiplication of a random variable with a constant</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simple-programming.html"><a href="simple-programming.html"><i class="fa fa-check"></i><b>7</b> Simple programming</a><ul>
<li class="chapter" data-level="7.1" data-path="simple-programming.html"><a href="simple-programming.html#using-for-loops"><i class="fa fa-check"></i><b>7.1</b> Using for-loops</a></li>
<li class="chapter" data-level="7.2" data-path="simple-programming.html"><a href="simple-programming.html#the-if-condition"><i class="fa fa-check"></i><b>7.2</b> The if-Condition</a></li>
<li class="chapter" data-level="7.3" data-path="simple-programming.html"><a href="simple-programming.html#the-while-loop"><i class="fa fa-check"></i><b>7.3</b> The while-loop</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="construction-of-functions.html"><a href="construction-of-functions.html"><i class="fa fa-check"></i><b>8</b> Construction of functions</a><ul>
<li class="chapter" data-level="8.1" data-path="construction-of-functions.html"><a href="construction-of-functions.html#simple-functions"><i class="fa fa-check"></i><b>8.1</b> Simple functions</a></li>
<li class="chapter" data-level="8.2" data-path="construction-of-functions.html"><a href="construction-of-functions.html#functions-with-multiple-output-objects"><i class="fa fa-check"></i><b>8.2</b> Functions with multiple output objects</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-exercises.html"><a href="r-exercises.html"><i class="fa fa-check"></i><b>9</b> R Exercises</a><ul>
<li class="chapter" data-level="9.1" data-path="r-exercises.html"><a href="r-exercises.html#matrices-1"><i class="fa fa-check"></i><b>9.1</b> Matrices</a></li>
<li class="chapter" data-level="9.2" data-path="r-exercises.html"><a href="r-exercises.html#sums-and-frequencies-1"><i class="fa fa-check"></i><b>9.2</b> Sums and frequencies</a></li>
<li class="chapter" data-level="9.3" data-path="r-exercises.html"><a href="r-exercises.html#logical-operators"><i class="fa fa-check"></i><b>9.3</b> Logical Operators</a></li>
<li class="chapter" data-level="9.4" data-path="r-exercises.html"><a href="r-exercises.html#statistical-distributions-1"><i class="fa fa-check"></i><b>9.4</b> Statistical Distributions</a><ul>
<li class="chapter" data-level="9.4.1" data-path="r-exercises.html"><a href="r-exercises.html#exercise-1"><i class="fa fa-check"></i><b>9.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="9.4.2" data-path="r-exercises.html"><a href="r-exercises.html#exercise-2"><i class="fa fa-check"></i><b>9.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="9.4.3" data-path="r-exercises.html"><a href="r-exercises.html#exercise-3"><i class="fa fa-check"></i><b>9.4.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="r-exercises.html"><a href="r-exercises.html#loops-and-functions"><i class="fa fa-check"></i><b>9.5</b> Loops and functions</a><ul>
<li class="chapter" data-level="9.5.1" data-path="r-exercises.html"><a href="r-exercises.html#exercise-1-1"><i class="fa fa-check"></i><b>9.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="9.5.2" data-path="r-exercises.html"><a href="r-exercises.html#exercise-2-1"><i class="fa fa-check"></i><b>9.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="9.5.3" data-path="r-exercises.html"><a href="r-exercises.html#exercise-3-1"><i class="fa fa-check"></i><b>9.5.3</b> Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="problem-set-1.html"><a href="problem-set-1.html"><i class="fa fa-check"></i><b>10</b> Problem Set 1</a><ul>
<li class="chapter" data-level="10.1" data-path="problem-set-1.html"><a href="problem-set-1.html#estimating-model-parameters"><i class="fa fa-check"></i><b>10.1</b> Estimating model parameters</a></li>
<li class="chapter" data-level="10.2" data-path="problem-set-1.html"><a href="problem-set-1.html#estimate-r2-and-barr2"><i class="fa fa-check"></i><b>10.2</b> Estimate <span class="math inline">\(R^2\)</span> and <span class="math inline">\(\bar{R^2}\)</span></a></li>
<li class="chapter" data-level="10.3" data-path="problem-set-1.html"><a href="problem-set-1.html#simulation-study"><i class="fa fa-check"></i><b>10.3</b> Simulation study</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="problem-set-2.html"><a href="problem-set-2.html"><i class="fa fa-check"></i><b>11</b> Problem Set 2</a><ul>
<li class="chapter" data-level="11.1" data-path="problem-set-2.html"><a href="problem-set-2.html#implementing-the-f-statistic"><i class="fa fa-check"></i><b>11.1</b> Implementing the F-statistic</a></li>
<li class="chapter" data-level="11.2" data-path="problem-set-2.html"><a href="problem-set-2.html#simulation-study-1"><i class="fa fa-check"></i><b>11.2</b> Simulation Study</a></li>
<li class="chapter" data-level="11.3" data-path="problem-set-2.html"><a href="problem-set-2.html#simulation-study-violating-model-assumptions"><i class="fa fa-check"></i><b>11.3</b> Simulation study: Violating model assumptions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="problem-set-3-power-and-size.html"><a href="problem-set-3-power-and-size.html"><i class="fa fa-check"></i><b>12</b> Problem Set 3: Power and Size</a><ul>
<li class="chapter" data-level="12.1" data-path="problem-set-3-power-and-size.html"><a href="problem-set-3-power-and-size.html#size"><i class="fa fa-check"></i><b>12.1</b> Size</a></li>
<li class="chapter" data-level="12.2" data-path="problem-set-3-power-and-size.html"><a href="problem-set-3-power-and-size.html#simulation-study-size"><i class="fa fa-check"></i><b>12.2</b> Simulation Study: Size</a></li>
<li class="chapter" data-level="12.3" data-path="problem-set-3-power-and-size.html"><a href="problem-set-3-power-and-size.html#simulation-study-power"><i class="fa fa-check"></i><b>12.3</b> Simulation study: Power</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="problem-set-4-np-density-estimation.html"><a href="problem-set-4-np-density-estimation.html"><i class="fa fa-check"></i><b>13</b> Problem Set 4: NP-Density estimation</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Script Introduction to Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="problem-set-3-power-and-size" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Problem Set 3: Power and Size</h1>
<p>The model used in the simulation has the following structure:</p>
<p>There is one constant and 9 covariates in the model and there are ten outcomes, all generated randomly.</p>
<p><span class="math display">\[x_{i1}=1, x_{i2},...,x_{i10} \sim \mathcal{N}(0,\mathbf{1})\]</span></p>
<p><span class="math display">\[ y_{i1}...,y_{i10} \sim \mathcal{N}(\mathbf{0},\mathbf{1})\]</span></p>
<p>Assume initially that <span class="math inline">\(n=1000\)</span> and <span class="math inline">\(\boldsymbol{\varepsilon}_i\sim\mathcal{N}(\mathbf{0},\mathbf{1})\)</span></p>
<div id="size" class="section level2">
<h2><span class="header-section-number">12.1</span> Size</h2>
<p>For one random draw, regress each <span class="math inline">\(y_i\)</span> on all covariates and calculate <span class="math inline">\(\hat{\beta}\)</span>. Test each coefficient for significance and record the number of coefficients that are estimated to be significant at the 5% level. What would be the expected number?</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">###Set the numerical values######</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">N=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">k=<span class="dv">10</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">p=<span class="dv">10</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">X<span class="fl">.1</span>       &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, N)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">X<span class="fl">.2</span>&lt;-<span class="kw">rnorm</span>(N<span class="op">*</span>(k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">X         &lt;-<span class="st"> </span><span class="kw">cbind</span>(X<span class="fl">.1</span>, <span class="kw">matrix</span>(X<span class="fl">.2</span>,<span class="dt">nrow=</span>N,<span class="dt">ncol=</span>k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">Beta&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,p,k)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">P&lt;-<span class="kw">nrow</span>(Beta)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">Q&lt;-<span class="kw">ncol</span>(Beta)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">###Concentrate on the relevant starts and stops </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">E &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(N<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),N, p, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">Y&lt;-X<span class="op">%*%</span>Beta<span class="op">+</span>E </a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">##alternatively: Y.1&lt;-rnorm()</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">##Solving for beta hat###</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">    yy&lt;-<span class="kw">dim</span>(Y)</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">    length.y&lt;-yy[<span class="dv">2</span>]<span class="co">###gives the number of output variables</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">    xx&lt;-<span class="kw">dim</span>(X)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">    length.x&lt;-xx[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb1-23" data-line-number="23">    <span class="co">###The beta matrix gives the dimension of the original problem###</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24">    beta.hat&lt;-<span class="kw">mat.or.vec</span>(length.x, length.y)</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">    d1&lt;-<span class="kw">mat.or.vec</span>(length.x, length.y)</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">    t&lt;-<span class="kw">mat.or.vec</span>(length.x, length.y)</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">    y.hat&lt;-<span class="kw">mat.or.vec</span>(N,length.y)</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">    eps.hat&lt;-<span class="kw">mat.or.vec</span>(N,length.y)</a>
<a class="sourceLine" id="cb1-29" data-line-number="29">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>length.y)</a>
<a class="sourceLine" id="cb1-30" data-line-number="30">    {</a>
<a class="sourceLine" id="cb1-31" data-line-number="31">      beta.hat[,i]&lt;-<span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>Y[,i]</a>
<a class="sourceLine" id="cb1-32" data-line-number="32">      y.hat[,i]&lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta.hat[,i]</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">      eps.hat[,i]&lt;-Y[,i]<span class="op">-</span>X <span class="op">%*%</span><span class="st"> </span>beta.hat[,i]</a>
<a class="sourceLine" id="cb1-34" data-line-number="34">      se&lt;-(<span class="kw">t</span>(eps.hat[,i])<span class="op">%*%</span>(eps.hat[,i]))<span class="op">/</span>(N<span class="op">-</span>length.x)</a>
<a class="sourceLine" id="cb1-35" data-line-number="35">      cov&lt;-se[<span class="dv">1</span>]<span class="op">*</span><span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X)</a>
<a class="sourceLine" id="cb1-36" data-line-number="36">      d1[,i]&lt;-<span class="kw">sqrt</span>(<span class="kw">diag</span>(cov))</a>
<a class="sourceLine" id="cb1-37" data-line-number="37">      t[,i]&lt;-beta.hat[,i]<span class="op">/</span>d1[,i]</a>
<a class="sourceLine" id="cb1-38" data-line-number="38">    }</a>
<a class="sourceLine" id="cb1-39" data-line-number="39">    t&lt;-<span class="kw">as.matrix</span>(t)</a>
<a class="sourceLine" id="cb1-40" data-line-number="40">    <span class="co">###critical values from the t-distribution###</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41">    t.crit_alpha&lt;-<span class="kw">abs</span>(<span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, N<span class="op">-</span>length.x))</a>
<a class="sourceLine" id="cb1-42" data-line-number="42">    <span class="co">###compare the t statistic values: </span><span class="al">###</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43">    sig_alpha&lt;-<span class="kw">abs</span>(t)<span class="op">&gt;</span>t.crit_alpha</a>
<a class="sourceLine" id="cb1-44" data-line-number="44">    <span class="co">######Record the number significant coefficients#####</span></a>
<a class="sourceLine" id="cb1-45" data-line-number="45">    FP&lt;-<span class="kw">sum</span>(sig_alpha)</a></code></pre></div>
</div>
<div id="simulation-study-size" class="section level2">
<h2><span class="header-section-number">12.2</span> Simulation Study: Size</h2>
<p>Write the code above into a function that returns the sum of significant coefficients and repeat this for varying sample sizes, ranging from 500 and increase to 50000 in an interval spacing of your choice. Record your results in a vector. What is the expected number of rejected hypotheses in this scenario? Plot the number of rejected hypotheses against the sample size. Summarize your results.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">simu_data&lt;-<span class="cf">function</span>(N){</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">k=<span class="dv">10</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">p=<span class="dv">10</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">X<span class="fl">.1</span>       &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, N)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">X<span class="fl">.2</span>&lt;-<span class="kw">rnorm</span>(N<span class="op">*</span>(k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">X         &lt;-<span class="st"> </span><span class="kw">cbind</span>(X<span class="fl">.1</span>, <span class="kw">matrix</span>(X<span class="fl">.2</span>,<span class="dt">nrow=</span>N,<span class="dt">ncol=</span>k<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">Beta&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,p,k)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">P&lt;-<span class="kw">nrow</span>(Beta)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">Q&lt;-<span class="kw">ncol</span>(Beta)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">###Concentrate on the relevant starts and stops </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">E &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(N<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),N, p, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">Y&lt;-X<span class="op">%*%</span>Beta<span class="op">+</span>E </a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">##alternatively: Y.1&lt;-rnorm()</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">##Solving for beta hat###</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">    yy&lt;-<span class="kw">dim</span>(Y)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">    length.y&lt;-yy[<span class="dv">2</span>]<span class="co">###gives the number of output variables</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">    xx&lt;-<span class="kw">dim</span>(X)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">    length.x&lt;-xx[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">    <span class="co">###The beta matrix gives the dimension of the original problem###</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22">    beta.hat&lt;-<span class="kw">mat.or.vec</span>(length.x, length.y)</a>
<a class="sourceLine" id="cb2-23" data-line-number="23">    d1&lt;-<span class="kw">mat.or.vec</span>(length.x, length.y)</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">    t&lt;-<span class="kw">mat.or.vec</span>(length.x, length.y)</a>
<a class="sourceLine" id="cb2-25" data-line-number="25">    y.hat&lt;-<span class="kw">mat.or.vec</span>(N,length.y)</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">    eps.hat&lt;-<span class="kw">mat.or.vec</span>(N,length.y)</a>
<a class="sourceLine" id="cb2-27" data-line-number="27">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>length.y)</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">    {</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">      beta.hat[,i]&lt;-<span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>Y[,i]</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">      y.hat[,i]&lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta.hat[,i]</a>
<a class="sourceLine" id="cb2-31" data-line-number="31">      eps.hat[,i]&lt;-Y[,i]<span class="op">-</span>X <span class="op">%*%</span><span class="st"> </span>beta.hat[,i]</a>
<a class="sourceLine" id="cb2-32" data-line-number="32">      se&lt;-(<span class="kw">t</span>(eps.hat[,i])<span class="op">%*%</span>(eps.hat[,i]))<span class="op">/</span>(N<span class="op">-</span>length.x)</a>
<a class="sourceLine" id="cb2-33" data-line-number="33">      cov&lt;-se[<span class="dv">1</span>]<span class="op">*</span><span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X)</a>
<a class="sourceLine" id="cb2-34" data-line-number="34">      d1[,i]&lt;-<span class="kw">sqrt</span>(<span class="kw">diag</span>(cov))</a>
<a class="sourceLine" id="cb2-35" data-line-number="35">      t[,i]&lt;-beta.hat[,i]<span class="op">/</span>d1[,i]</a>
<a class="sourceLine" id="cb2-36" data-line-number="36">    }</a>
<a class="sourceLine" id="cb2-37" data-line-number="37">    t&lt;-<span class="kw">as.matrix</span>(t)</a>
<a class="sourceLine" id="cb2-38" data-line-number="38">    <span class="co">###critical values from the t-distribution###</span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39">    t.crit_alpha&lt;-<span class="kw">abs</span>(<span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, N<span class="op">-</span>length.x))</a>
<a class="sourceLine" id="cb2-40" data-line-number="40">    <span class="co">###compare the t statistic values: </span><span class="al">###</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41">    sig_alpha&lt;-<span class="kw">abs</span>(t)<span class="op">&gt;</span>t.crit_alpha</a>
<a class="sourceLine" id="cb2-42" data-line-number="42">    <span class="co">######Record the number significant coefficients#####</span></a>
<a class="sourceLine" id="cb2-43" data-line-number="43">    FP&lt;-<span class="kw">sum</span>(sig_alpha)</a>
<a class="sourceLine" id="cb2-44" data-line-number="44"><span class="kw">return</span>(FP)</a>
<a class="sourceLine" id="cb2-45" data-line-number="45">}</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">N=<span class="kw">seq</span>(<span class="dv">500</span>,<span class="dv">50000</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb2-47" data-line-number="47"></a>
<a class="sourceLine" id="cb2-48" data-line-number="48">result&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb2-49" data-line-number="49"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(N))</a>
<a class="sourceLine" id="cb2-50" data-line-number="50">{</a>
<a class="sourceLine" id="cb2-51" data-line-number="51">    <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb2-52" data-line-number="52">  result[i]=<span class="kw">simu_data</span>(N[i])</a>
<a class="sourceLine" id="cb2-53" data-line-number="53">}</a>
<a class="sourceLine" id="cb2-54" data-line-number="54"><span class="kw">plot</span>(N,result)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">mean</span>(result)</a></code></pre></div>
<pre><code>## [1] 5.014113</code></pre>
</div>
<div id="simulation-study-power" class="section level2">
<h2><span class="header-section-number">12.3</span> Simulation study: Power</h2>
<p>Now suppose that we have a univariate <span class="math inline">\(y_i=\beta x_i+\varepsilon_i\)</span> and only one regressor <span class="math inline">\(x_i\)</span> with a standard normal error term. In a simulation study, calculate the number of observations that are required to correctly reject the Null in at least 80% of the cases for <span class="math inline">\(\alpha=0.05\)</span> when <span class="math inline">\(\beta=0.1\)</span>. Check how much increasing the treatment effect by 0.1 (by increasing the dose for example) might be ``cheaper’’ in terms of required sample size.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">N=<span class="dv">10</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">beta&lt;-<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">simu_data&lt;-<span class="cf">function</span>(N,beta)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">{</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  eps       &lt;-<span class="kw">rnorm</span>(N)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">X&lt;-<span class="kw">cbind</span>(<span class="kw">rnorm</span>(N))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">y         &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span>eps</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">##Solving for beta hat###</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">beta.hat &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">beta.hat</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">xx&lt;-<span class="kw">dim</span>(X)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">length.x&lt;-xx[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">y.hat&lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta.hat</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">eps.hat&lt;-y<span class="op">-</span>X <span class="op">%*%</span><span class="st"> </span>beta.hat</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">se&lt;-(<span class="kw">t</span>(eps.hat)<span class="op">%*%</span>(eps.hat))<span class="op">/</span>(N<span class="op">-</span>length.x)</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">cov&lt;-se[<span class="dv">1</span>]<span class="op">*</span><span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">d1&lt;-<span class="kw">sqrt</span>(<span class="kw">diag</span>(cov))</a>
<a class="sourceLine" id="cb5-18" data-line-number="18">t&lt;-beta.hat<span class="op">/</span>d1</a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">###critical values from the t-distribution###</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">t.crit_<span class="fl">0.05</span>&lt;-<span class="kw">abs</span>(<span class="kw">qt</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>, N<span class="op">-</span>length.x))</a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">###significance###</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22">sig_<span class="fl">0.05</span>&lt;-<span class="kw">abs</span>(t)<span class="op">&gt;</span>t.crit_<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="kw">return</span>(sig_<span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb5-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb5-25" data-line-number="25">N=<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">1000</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">result&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(N))</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">{</a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">result[i]&lt;-<span class="kw">sum</span>(<span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">simu_data</span>(N[i],beta), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>))</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">}</a>
<a class="sourceLine" id="cb5-32" data-line-number="32"></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"></a>
<a class="sourceLine" id="cb5-34" data-line-number="34">sample_size=<span class="kw">min</span>(N[result<span class="op">&gt;</span><span class="dv">80</span>])</a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="co">##now check the whether increasing beta would be cheaper? </span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36">beta&lt;-<span class="fl">0.2</span></a>
<a class="sourceLine" id="cb5-37" data-line-number="37">N=<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">1000</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb5-38" data-line-number="38">result.beta&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(N))</a>
<a class="sourceLine" id="cb5-40" data-line-number="40">{</a>
<a class="sourceLine" id="cb5-41" data-line-number="41"><span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb5-42" data-line-number="42">result.beta[i]&lt;-<span class="kw">sum</span>(<span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">simu_data</span>(N[i],beta), <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>))</a>
<a class="sourceLine" id="cb5-43" data-line-number="43">}</a>
<a class="sourceLine" id="cb5-44" data-line-number="44">sample_size_beta=<span class="kw">min</span>(N[result.beta<span class="op">&gt;</span><span class="dv">80</span>])</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="problem-set-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="problem-set-4-np-density-estimation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/12-ProblemSet3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
