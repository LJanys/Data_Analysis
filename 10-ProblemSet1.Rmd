# Problem Set 1


The model used in the simulation has the following structure:

$$x_{i1}=1, x_{i2}:x_{i11} \sim \mathcal{N}(0,1)$$
$$y_{i}=\mathbf{x}_i'\boldsymbol{\beta}+\varepsilon$$
 with $\boldsymbol{\beta}=\left(\begin{matrix} 1&0.5 &0&0& 0& 0& 0& 0& 0& 0& 0 \end{matrix}\right)$ and $\varepsilon \sim \mathcal{N}(0,1)$ and $n=1000$.

## Estimating model parameters
Calculate $\hat{\boldsymbol{\beta}}$, $\hat{\mathbf{y}}$ and $\hat{\boldsymbol{\varepsilon}}$ and the standard errors of the coefficient estimates. Please try to program these entities yourself instead of using pre-specified functions in **R**. 

```{r dgp, include=T, error=TRUE,eval=F}
n=1000
M=10
####Specify the DGP########
X<-cbind(rep(1,n),matrix(rnorm(n*M,mean=0,sd=1), n, M)) 
  eps<-rnorm(n)
  beta.vec<-c(1,0.5,rep(0,M-1))
  y<-X%*%beta.vec+eps
##Solving for beta hat###
beta.hat <- solve(t(X) %*% X) %*% t(X) %*% y
beta.hat
k<-dim(X)[2]  
#####calculate the fitted values#####
y.hat<- X %*% beta.hat 
eps.hat<-y-X %*% beta.hat
###calculate the covariance matrix#
se<-(t(eps.hat)%*%(eps.hat))/(n-k)
cov<-se[1]*solve(t(X) %*% X)
d1<-sqrt(diag(cov))
```


## Estimate $R^2$ and $\bar{R^2}$

Calculate both the $R^2$ and the adjusted $R^2$ for one draw of the covariates and the full model specification.
```{r, include=T, error=TRUE,eval=F}
#Calculate the coefficient of determination#
r_squared<-sum((y.hat-mean(y.hat))^2)/sum((y-mean(y))^2)
##adjusted r squared
r_squared.adj<-r_squared-(k-1)/(n-k)*(1-r_squared)
```
## Simulation study

In a suitably designed simulation, show the behaviour of the $R^2$ and the adjusted $R^2$ when starting only with a constant and add covariates sequentially to the model. 

```{r, include=T, error=TRUE,eval=F}
n=1000##number of observations in each simulation
r=1000####Number of simulation runs
m1=1:50
m=rep(m1,each=r)
rep<-length(m)
adj.R<-c()
R.sq<-c()
for (i in 1:rep)
{
  N=n
  M=m[i]
  X<-cbind(rep(1,n),matrix(rnorm(N*M,mean=0,sd=1), N, M)) 
  eps<-rnorm(N)
  beta.vec<-c(1,0.5,rep(0,M-1))
  y<-X%*%beta.vec+eps
  lm.result   <- lm(y~X)
  R.sq[i]<-summary(lm(y~X))$r.squared
  adj.R[i]<-summary(lm(y~X))$adj.r.squared
  print(i)
}
A<-matrix(adj.R,r,length(m1))
B<-matrix(R.sq,r,length(m1))
plot(colMeans(B),type="l",ylim=c(min(colMeans(A)),max(colMeans(B))))
lines(colMeans(A),col="red",lty=2)
```




